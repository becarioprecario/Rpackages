---
title: "Introduction to Rcpp"
author: "Virgilio GÃ³mez Rubio"
date : ""
output:
  ioslides_presentation:
    incremental: false
    self-included: true
    css: styles.css
    #logo: uclm.jpg
---


## What is Rcpp?

* `Rcpp` is a package that provides a seamless integration of `R` and `C++`.

* Check the following for details:

[http://dirk.eddelbuettel.com/code/rcpp/rcpp.html](http://dirk.eddelbuettel.com/code/rcpp/rcpp.html)

* More details here:

       ![](images/cover_Rcpp_small.png) [D. Eddelbuettel (2013). Seamless R and C++ Integration with Rcpp. Springer.](http://www.rcpp.org/book/)



## How to use `C++` code 


* Place yor `C++` code under `mypkg/src`.

* Run `devtools::use_rcpp()`

    * Add some stuff to the `rdoxygen` files to use `Rcpp`.

    * Modify the `DESCRIPTION` to import and link to `Rcpp`.


* Add the following to the `C++` file to make the functiona available
to `R`:

```
#include <Rcpp.h>
using namespace Rcpp;

// [[Rcpp::export]] 
```


## How to use `C++` code 

* Add `rdoxygen` documentation to the `C++` code. Use `//' @..` instead
of `#' @...`. 

* Note that you may need an additional `//' @export ` to export the function
in the `NAMESPACE` to make it widely avalable.

* Run `document` to create the necessary headers.

* Run `devtools::load_all()` to load the package and check the functions
manually.

* Write and run some tests.

* Run `devtools::check()`.


## The `sumRcpp` package

* The `sumRcpp` package provide animplementation of the addition
of two numbers using `Rcpp`.

* It is similar to `sumR`.

* Including and exporting the `C++` code with `Rcpp` is simpler now because:

    * No need to create an `R` wrapper function.

    * No need to register `C` functions.

* `Rcpp` creates `mypkg/src/RcppExports.cpp` with a wrapper function in 
`C` and a register of the functions.

* `Rcpp` creates `mypkg/R/RcppExports.R` with a wrapper function in 
`R` using the `.Call` interface.



## Example: `sumRcpp` 

File `sumRcpp/src/sumRRcpp`.

```
#include <Rcpp.h>
using namespace Rcpp;

//' @name sumRRcpp
//' @rdname sumR
//'
//' @examples
//' sumRRcpp(1, 2)
//'
//' @details \code{sumRRcpp} is an implementation using the Rcpp interface.
//'
//' @export
// [[Rcpp::export]]
double sumRRcpp (double x, double y) {
  return x + y;
}
```

## Example: `sumRcpp` {.smaller}

File `sumRcpp/src/RcppExports.cpp`.

```
// Generated by using Rcpp::compileAttributes() -> do not edit by hand
// Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#include <Rcpp.h>

using namespace Rcpp;

// sumRRcpp
double sumRRcpp(double x, double y);
RcppExport SEXP sumRcpp_sumRRcpp(SEXP xSEXP, SEXP ySEXP) {
BEGIN_RCPP
    Rcpp::RObject rcpp_result_gen;
    Rcpp::RNGScope rcpp_rngScope_gen;
    Rcpp::traits::input_parameter< double >::type x(xSEXP);
    Rcpp::traits::input_parameter< double >::type y(ySEXP);
    rcpp_result_gen = Rcpp::wrap(sumRRcpp(x, y));
    return rcpp_result_gen;
END_RCPP
}

static const R_CallMethodDef CallEntries[] = {
    {"sumRcpp_sumRRcpp", (DL_FUNC) &sumRcpp_sumRRcpp, 2},
    {NULL, NULL, 0}
};

RcppExport void R_init_sumRcpp(DllInfo *dll) {
    R_registerRoutines(dll, NULL, CallEntries, NULL, NULL);
    R_useDynamicSymbols(dll, FALSE);
}
```

## Example: `sumRcpp`

File `sumRcpp/R/RcppExports.R`.

```
# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' @name sumRRcpp
#' @rdname sumR
#'
#' @examples
#' sumRRcpp(1, 2)
#'
#' @details \code{sumRRcpp} is an implementation using the Rcpp interface.
#'
#' @export
sumRRcpp <- function(x, y) {
    .Call('sumRcpp_sumRRcpp', PACKAGE = 'sumRcpp', x, y)
}
```
